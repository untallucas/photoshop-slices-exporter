#target photoshop// PROMPT FOR USER INPUTvar slicesGroup = prompt( "Enter the name of the layer group that contains your slices", "SLICES" );var filePrefix = prompt( "Set the export file name prefix", "" );var fileSuffix = prompt( "Set the export file name suffix", "" );var fileName = prompt( "Set file name", app.activeDocument.name.split('.')[0].toLowerCase() );if( !slicesGroup ){	slicesGroup = "SLICES";}if( !filePrefix ){	filePrefix = "";}else {	filePrefix = filePrefix+'_';}if( !fileSuffix ){	fileSuffix = "";}else {	fileSuffix = '_'+fileSuffix;}if( !fileName ){	fileName = app.activeDocument.name.split('.')[0].toLowerCase();}function getPngOptions(){	var pngExportOptions = new ExportOptionsSaveForWeb();	pngExportOptions.format = SaveDocumentType.PNG;	pngExportOptions.optimized = true;	pngExportOptions.PNG8 = false;	return pngExportOptions;}function slicesExporter(){	// GET ALL DOCUMENT LAYER GROUPS	var layerSets = app.activeDocument.layerSets;	// COUNT DOCUMENT LAYER GROUPS	var len = layerSets.length;	// GET ACTIVE DOCUMENT	var currentDocument = app.activeDocument;	// GET ACTIVE DOCUMENT FILENAME	var currentFilename = currentDocument.fullName;	// GET ACTIVE DOCUMENT FOLDER	var folder = currentFilename.parent.selectDlg("Select a folder to export images");	// GET PNG EXPORT OPTIONS	var options = getPngOptions();	// SETS AN HISTORY STATE TO RECOVER AFTER THE SCRIPT RUNS	var historySavedState = currentDocument.activeHistoryState;	// RESET SLICES LAYER GROUP EXISTENCE	var isSliceLayer = false;	// FOR EACH LAYER GROUP	for( var i = 0; i < len; i++ ){		// GET LAYER		var layerSet = layerSets[i];		// VERIFIES IS LAYER GROUP NAME MATCHES SLICES NAME FOLDER		if( layerSet.name == slicesGroup ){			// SETS SLICES LAYER GROUP EXISTENCE TO TRUE			isSliceLayer = true;			// GET GROUP LAYERS			var layers = layerSet.artLayers;			// COUNT GROUP LAYERS			var len = layers.length;			// FOR EACH LAYER			for( var i = 0; i < len; i++){				// GET LAYER				var layer = layers[i];				// CROP DOCUMENT TO SLICE LAYER BOUNDARIES				activeDocument.crop( layer.bounds, 0, layer.bounds[2] - layer.bounds[0], layer.bounds[3] - layer.bounds[1] );				// HIDES SLICE LAYER				layer.visible = false;				// CREATES NEW PNG FILE				var file = new File(folder.fsName+'/'+filePrefix+fileName+fileSuffix+'_'+(i+1)+'.png');				// EXPORTS FILE				currentDocument.exportDocument( file, ExportType.SAVEFORWEB, options );				// REWINDS HISTORY STATE TO A STATE BEFORE THE SCRIPT RUNS				currentDocument.activeHistoryState = historySavedState;			}		}	}	// IF NO SLICES LAYER GROUP IS FOUND, MESSAGE IS SHOWN	if( !isSliceLayer ){		alert("There's no slices layer group. Please create a layer group called 'SLICES' and rerun script");	}	else {		alert("Thanks for using Slices Exporter Script!");	}}// slicesExporter();slicesExporter();